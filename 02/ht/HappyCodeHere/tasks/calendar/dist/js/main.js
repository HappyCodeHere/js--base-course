"use strict";function Calendar(e){var t=e.el,n=e.showControls,a=e.allowAddEvents,r=e.allowRemoveEvents,l=e.className,o=e.title;this.el=t,this.showControls=n,this.allowAddEvents=a,this.allowRemoveEvents=r,this.className=l,this.title=o,this.id=this.el.substring(1,4),this.run=function(){function e(){var e=localStorage.getItem("calendarData")[u];e&&(m=JSON.parse(e))}function t(){var e=document.createElement("button");e.className="btn-back",e.innerText="<",g.appendChild(e);var t=document.createElement("button");t.className="btn-forward",t.innerText=">",g.appendChild(t)}function n(e){if("button"===e.target.tagName.toLowerCase()){var t;t="btn-forward"===e.target.classList[0]?1:-1,c=new Date(c.setMonth(c.getMonth()+t));var n=document.querySelector("table"),r=document.querySelector(".title");r.remove(),n.parentNode.removeChild(n),a()}}function a(){var e=document.createElement("div");e.className="title",e.innerHTML=c.getFullYear()+"/"+(c.getMonth()+1),document.body.appendChild(e);var t=document.createElement("table");t.className="table table-bordered",t.innerHTML="<tbody><tr></tr></tbody>";var n=document.createElement("thead");n.innerHTML;for(var a=document.createElement("tr"),l=["mon","tue","wed","thu","fri","sat","sun"],o=0;o<l.length;o++){var i=document.createElement("th");i.innerHTML=l[o],a.appendChild(i)}n.insertBefore(a,n.childNodes[0]),t.insertBefore(n,t.childNodes[0]);var s=new Date(c.getFullYear(),c.getMonth(),1).getDay();0===s&&(s=7);for(var d=t.querySelector("tbody"),m=1;m<=new Date(c.getFullYear(),c.getMonth()+1,0).getDate();){if(a=t.querySelectorAll("tr"),1===m)for(var o=m;o<s;o++)a[a.length-1].innerHTML+="<td></td>";var u=document.createElement("td");u.innerHTML=m,u.className=1===String(m).length?"0"+m:m,a[a.length-1].appendChild(u),a[a.length-1].childElementCount>6&&(d.innerHTML+="<tr></tr>"),m++}main.appendChild(t),r()}function r(){for(var e in m)if(e.substring(0,8)===c.toISOString().substring(0,8)){var t=document.getElementsByClassName(""+String(e.substring(8,10)));o(t[0],m[e])}}function l(){if("td"===event.target.tagName.toLowerCase()){var e=prompt("What will you do?");o(event.target,e),i(event,e)}}function o(e,t){var n=document.createElement("div");n.className="event "+e.className,n.innerHTML='<span class="delete">x</span><br>'+t,e.appendChild(n)}function i(e,t){var n=c.toISOString().substring(0,8)+e.target.className;m[n]||(m[n]=t,localStorage.setItem("calendarData",JSON.stringify(m)))}function s(e){var t=c.toISOString().substring(0,8)+e.target.parentNode.classList[1];delete m[t],localStorage.setItem("calendarData",JSON.stringify(m))}function d(){"span"===event.target.tagName.toLowerCase()&&(event.target.parentNode.remove(),s(event))}var c=new Date,m={},u=this.id,g=document.getElementById(this.id);e(),t(),a(),g.addEventListener("dblclick",l),g.addEventListener("click",d),g.addEventListener("click",n)}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiQ2FsZW5kYXIiLCJjb25maWciLCJlbCIsInNob3dDb250cm9scyIsImFsbG93QWRkRXZlbnRzIiwiYWxsb3dSZW1vdmVFdmVudHMiLCJjbGFzc05hbWUiLCJ0aXRsZSIsInRoaXMiLCJpZCIsInN1YnN0cmluZyIsInJ1biIsImxvYWRFdmVudHMiLCJjYWxlbmRhckRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZXZlbnRzIiwiSlNPTiIsInBhcnNlIiwicmVuZGVyQnV0dG9ucyIsImxlZnRCdXR0b24iLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lclRleHQiLCJtYWluRGl2IiwiYXBwZW5kQ2hpbGQiLCJyaWdodEJ1dHRvbiIsImhhbmRsZUJ1dHRvbiIsImV2ZW50IiwidGFyZ2V0IiwidGFnTmFtZSIsInRvTG93ZXJDYXNlIiwibnVtIiwiY2xhc3NMaXN0IiwiY3VycmVudERhdGUiLCJEYXRlIiwic2V0TW9udGgiLCJnZXRNb250aCIsImRlbGV0ZTEiLCJxdWVyeVNlbGVjdG9yIiwiZGVsZXRlMiIsInJlbW92ZSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsInJlbmRlckNhbGVuZGFyIiwiZGl2IiwiaW5uZXJIVE1MIiwiZ2V0RnVsbFllYXIiLCJib2R5IiwidGFibGUiLCJ0aGVhZCIsInRyIiwidGhOYW1lIiwiaSIsImxlbmd0aCIsInRoIiwiaW5zZXJ0QmVmb3JlIiwiY2hpbGROb2RlcyIsImZpcnN0RGF5IiwiZ2V0RGF5IiwidGJvZHkiLCJkYXkiLCJnZXREYXRlIiwicXVlcnlTZWxlY3RvckFsbCIsInRkIiwiU3RyaW5nIiwiY2hpbGRFbGVtZW50Q291bnQiLCJtYWluIiwicmVuZGVyRXZlbnRzIiwiZXZlbnREYXRlIiwidG9JU09TdHJpbmciLCJldmVudERheSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJyZW5kZXJFdmVudCIsImFkZFVzZXJFdmVudCIsInRleHQiLCJwcm9tcHQiLCJzYXZlRXZlbnRUb0xvY2FsU3RvcmFnZSIsIndoZXJlIiwic2F2ZURhdGUiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiZGVsZXRlRXZlbnRGcm9tTG9jYWxTdG9yYWdlIiwiZGVsZXRlRGF0ZSIsImRlbGV0ZVVzZXJFdmVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBQSxTQUFTQSxVQUFTQyxHQUFRLEdBQ2hCQyxHQUEwRUQsRUFBMUVDLEdBQUlDLEVBQXNFRixFQUF0RUUsYUFBY0MsRUFBd0RILEVBQXhERyxlQUFnQkMsRUFBd0NKLEVBQXhDSSxrQkFBbUJDLEVBQXFCTCxFQUFyQkssVUFBV0MsRUFBVU4sRUFBVk0sS0FFeEVDLE1BQUtOLEdBQUtBLEVBQ1ZNLEtBQUtMLGFBQWVBLEVBQ3BCSyxLQUFLSixlQUFpQkEsRUFDdEJJLEtBQUtILGtCQUFvQkEsRUFDekJHLEtBQUtGLFVBQVlBLEVBQ2pCRSxLQUFLRCxNQUFRQSxFQUViQyxLQUFLQyxHQUFLRCxLQUFLTixHQUFHUSxVQUFVLEVBQUcsR0FHL0JGLEtBQUtHLElBQU0sV0FnQlQsUUFBU0MsS0FDUCxHQUFJQyxHQUFlQyxhQUFhQyxRQUFRLGdCQUFnQk4sRUFDckRJLEtBQ0RHLEVBQVNDLEtBQUtDLE1BQU1MLElBSXhCLFFBQVNNLEtBQ1AsR0FBSUMsR0FBYUMsU0FBU0MsY0FBYyxTQUN4Q0YsR0FBV2QsVUFBWSxXQUN2QmMsRUFBV0csVUFBWSxJQUN2QkMsRUFBUUMsWUFBWUwsRUFFcEIsSUFBSU0sR0FBY0wsU0FBU0MsY0FBYyxTQUN6Q0ksR0FBWXBCLFVBQVksY0FDeEJvQixFQUFZSCxVQUFZLElBQ3hCQyxFQUFRQyxZQUFZQyxHQUd0QixRQUFTQyxHQUFhQyxHQUNwQixHQUEwQyxXQUF2Q0EsRUFBTUMsT0FBT0MsUUFBUUMsY0FBeEIsQ0FDQSxHQUFJQyxFQUMwQ0EsR0FBaEIsZ0JBQTlCSixFQUFNQyxPQUFPSSxVQUFVLEdBQTZCLEtBQ3BEQyxFQUFjLEdBQUlDLE1BQUtE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QVEsZUFBZ0IvRCxLQUFLZ0UsVUFBVWpFLEtBR3RELFFBQVNrRSxHQUE0QnRELEdBQ25DLEdBQUl1RCxHQUFhakQsRUFBWW9DLGNBQWM1RCxVQUFVLEVBQUcsR0FBS2tCLEVBQU1DLE9BQU9hLFdBQVdULFVBQVUsU0FDeEZqQixHQUFPbUUsR0FDZHJFLGFBQWFrRSxRQUFRLGVBQWdCL0QsS0FBS2dFLFVBQVVqRSxJQUd0RCxRQUFTb0UsS0FDbUMsU0FBdkN4RCxNQUFNQyxPQUFPQyxRQUFRQyxnQkFDeEJILE1BQU1DLE9BQU9hLFdBQVdELFNBRXhCeUMsRUFBNEJ0RCxRQTNKOUIsR0FBSU0sR0FBYyxHQUFJQyxNQUNsQm5CLEtBRUFQLEVBQUtELEtBQUtDLEdBQ1ZlLEVBQVVILFNBQVNnRSxlQUFlN0UsS0FBS0MsR0FFM0NHLEtBRUFPLElBQ0F5QixJQUVBcEIsRUFBUThELGlCQUFpQixXQUFZWixHQUNyQ2xELEVBQVE4RCxpQkFBaUIsUUFBU0YsR0FDbEM1RCxFQUFROEQsaUJBQWlCLFFBQVMzRCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQ2FsZW5kYXIoY29uZmlnKSB7XHJcbiAgY29uc3QgeyBlbCwgc2hvd0NvbnRyb2xzLCBhbGxvd0FkZEV2ZW50cywgYWxsb3dSZW1vdmVFdmVudHMsIGNsYXNzTmFtZSwgdGl0bGUgfSA9IGNvbmZpZztcclxuXHJcbiAgdGhpcy5lbCA9IGVsO1xyXG4gIHRoaXMuc2hvd0NvbnRyb2xzID0gc2hvd0NvbnRyb2xzO1xyXG4gIHRoaXMuYWxsb3dBZGRFdmVudHMgPSBhbGxvd0FkZEV2ZW50cztcclxuICB0aGlzLmFsbG93UmVtb3ZlRXZlbnRzID0gYWxsb3dSZW1vdmVFdmVudHM7XHJcbiAgdGhpcy5jbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG5cclxuICB0aGlzLmlkID0gdGhpcy5lbC5zdWJzdHJpbmcoMSwgNCk7XHJcblxyXG5cclxuICB0aGlzLnJ1biA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIHZhciBldmVudHMgPSB7fTtcclxuXHJcbiAgICB2YXIgaWQgPSB0aGlzLmlkO1xyXG4gICAgdmFyIG1haW5EaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmlkKTtcclxuXHJcbiAgICBsb2FkRXZlbnRzKCk7XHJcblxyXG4gICAgcmVuZGVyQnV0dG9ucygpO1xyXG4gICAgcmVuZGVyQ2FsZW5kYXIoKTtcclxuXHJcbiAgICBtYWluRGl2LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgYWRkVXNlckV2ZW50KTtcclxuICAgIG1haW5EaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWxldGVVc2VyRXZlbnQpO1xyXG4gICAgbWFpbkRpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUJ1dHRvbik7XHJcblxyXG4gICAgZnVuY3Rpb24gbG9hZEV2ZW50cygpIHtcclxuICAgICAgdmFyIGNhbGVuZGFyRGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYWxlbmRhckRhdGEnKVtpZF07XHJcbiAgICAgIGlmKGNhbGVuZGFyRGF0YSkge1xyXG4gICAgICAgIGV2ZW50cyA9IEpTT04ucGFyc2UoY2FsZW5kYXJEYXRhKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlbmRlckJ1dHRvbnMoKSB7XHJcbiAgICAgIHZhciBsZWZ0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICAgIGxlZnRCdXR0b24uY2xhc3NOYW1lID0gJ2J0bi1iYWNrJztcclxuICAgICAgbGVmdEJ1dHRvbi5pbm5lclRleHQgPSAnPCdcclxuICAgICAgbWFpbkRpdi5hcHBlbmRDaGlsZChsZWZ0QnV0dG9uKTtcclxuXHJcbiAgICAgIHZhciByaWdodEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICByaWdodEJ1dHRvbi5jbGFzc05hbWUgPSAnYnRuLWZvcndhcmQnO1xyXG4gICAgICByaWdodEJ1dHRvbi5pbm5lclRleHQgPSAnPic7XHJcbiAgICAgIG1haW5EaXYuYXBwZW5kQ2hpbGQocmlnaHRCdXR0b24pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUJ1dHRvbihldmVudCkge1xyXG4gICAgICBpZihldmVudC50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9PSAnYnV0dG9uJykgcmV0dXJuO1xyXG4gICAgICB2YXIgbnVtO1xyXG4gICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0WzBdID09PSAnYnRuLWZvcndhcmQnID8gbnVtID0gMSA6IG51bSA9IC0xXHJcbiAgICAgIGN1cnJlbnREYXRlID0gbmV3IERhdGUoY3VycmVudERhdGUuc2V0TW9udGgoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIG51bSkpO1xyXG5cclxuICAgICAgdmFyIGRlbGV0ZTEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd0YWJsZScpO1xyXG4gICAgICB2YXIgZGVsZXRlMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50aXRsZScpO1xyXG4gICAgICBkZWxldGUyLnJlbW92ZSgpO1xyXG4gICAgICBkZWxldGUxLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZGVsZXRlMSk7XHJcbiAgICAgIHJlbmRlckNhbGVuZGFyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVuZGVyQ2FsZW5kYXIoKSB7XHJcblxyXG4gICAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgIGRpdi5jbGFzc05hbWUgPSAndGl0bGUnO1xyXG4gICAgICBkaXYuaW5uZXJIVE1MID0gY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSArICcvJyArIChjdXJyZW50RGF0ZS5nZXRNb250aCgpKzEpO1xyXG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7XHJcblxyXG4gICAgICB2YXIgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScpO1xyXG4gICAgICB0YWJsZS5jbGFzc05hbWUgPSAndGFibGUgdGFibGUtYm9yZGVyZWQnO1xyXG4gICAgICB0YWJsZS5pbm5lckhUTUwgPSAnPHRib2R5Pjx0cj48L3RyPjwvdGJvZHk+JztcclxuICAgICAgdmFyIHRoZWFkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGhlYWQnKTtcclxuICAgICAgdGhlYWQuaW5uZXJIVE1MXHJcbiAgICAgIHZhciB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XHJcbiAgICAgIHZhciB0aE5hbWUgPSBbJ21vbicsICd0dWUnLCAnd2VkJywgJ3RodScsICdmcmknLCAnc2F0JywgJ3N1biddO1xyXG5cclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aE5hbWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB2YXIgdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xyXG4gICAgICAgIHRoLmlubmVySFRNTCA9IHRoTmFtZVtpXTtcclxuICAgICAgICB0ci5hcHBlbmRDaGlsZCh0aCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoZWFkLmluc2VydEJlZm9yZSh0ciwgdGhlYWQuY2hpbGROb2Rlc1swXSk7XHJcblxyXG4gICAgICB0YWJsZS5pbnNlcnRCZWZvcmUodGhlYWQsIHRhYmxlLmNoaWxkTm9kZXNbMF0pO1xyXG5cclxuICAgICAgdmFyIGZpcnN0RGF5ID0gbmV3IERhdGUoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSwgY3VycmVudERhdGUuZ2V0TW9udGgoKSwgMSkuZ2V0RGF5KCk7XHJcbiAgICAgIGlmKGZpcnN0RGF5ID09PSAwKSBmaXJzdERheSA9IDc7XHJcblxyXG4gICAgICB2YXIgdGJvZHkgPSB0YWJsZS5xdWVyeVNlbGVjdG9yKCd0Ym9keScpO1xyXG5cclxuICAgICAgdmFyIGRheSA9IDE7XHJcbiAgICAgIHdoaWxlIChkYXkgPD0gbmV3IERhdGUoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSwgKGN1cnJlbnREYXRlLmdldE1vbnRoKCkrMSksIDApLmdldERhdGUoKSkge1xyXG5cclxuICAgICAgICB0ciA9IHRhYmxlLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk7XHJcblxyXG4gICAgICAgIGlmKGRheSA9PT0gMSApIHtcclxuICAgICAgICAgIGZvciAodmFyIGkgPSBkYXk7IGkgPCBmaXJzdERheTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRyW3RyLmxlbmd0aC0xXS5pbm5lckhUTUwgKz0gJzx0ZD48L3RkPic7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgICAgIHRkLmlubmVySFRNTCA9IGRheTtcclxuICAgICAgICB0ZC5jbGFzc05hbWUgPSBTdHJpbmcoZGF5KS5sZW5ndGggPT09IDEgPyAnMCcgKyBkYXkgOiBkYXk7XHJcbiAgICAgICAgdHJbdHIubGVuZ3RoLTFdLmFwcGVuZENoaWxkKHRkKTtcclxuXHJcbiAgICAgICAgaWYodHJbdHIubGVuZ3RoLTFdLmNoaWxkRWxlbWVudENvdW50ID4gNikge1xyXG4gICAgICAgICAgdGJvZHkuaW5uZXJIVE1MICs9ICc8dHI+PC90cj4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZGF5Kys7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG1haW4uYXBwZW5kQ2hpbGQodGFibGUpO1xyXG5cclxuICAgICAgcmVuZGVyRXZlbnRzKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlbmRlckV2ZW50cygpIHtcclxuICAgICAgZm9yICh2YXIgZXZlbnREYXRlIGluIGV2ZW50cykge1xyXG4gICAgICAgIGlmKGV2ZW50RGF0ZS5zdWJzdHJpbmcoMCwgOCkgPT09IGN1cnJlbnREYXRlLnRvSVNPU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDgpKSB7XHJcbiAgICAgICAgICB2YXIgZXZlbnREYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGAke1N0cmluZyhldmVudERhdGUuc3Vic3RyaW5nKDgsIDEwKSl9YCk7XHJcbiAgICAgICAgICByZW5kZXJFdmVudChldmVudERheVswXSwgZXZlbnRzW2V2ZW50RGF0ZV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFVzZXJFdmVudCgpIHtcclxuICAgICAgaWYoZXZlbnQudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ3RkJykgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIHRleHQgPSBwcm9tcHQoJ1doYXQgd2lsbCB5b3UgZG8/Jyk7XHJcblxyXG4gICAgICByZW5kZXJFdmVudChldmVudC50YXJnZXQsIHRleHQpO1xyXG4gICAgICBzYXZlRXZlbnRUb0xvY2FsU3RvcmFnZShldmVudCwgdGV4dCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVuZGVyRXZlbnQod2hlcmUsIHRleHQpIHtcclxuICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBkaXYuY2xhc3NOYW1lID0gJ2V2ZW50ICcgKyB3aGVyZS5jbGFzc05hbWU7XHJcbiAgICAgIGRpdi5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9XCJkZWxldGVcIj54PC9zcGFuPicgKyAnPGJyPicgKyB0ZXh0O1xyXG5cclxuICAgICAgd2hlcmUuYXBwZW5kQ2hpbGQoZGl2KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBzYXZlRXZlbnRUb0xvY2FsU3RvcmFnZShldmVudCwgdGV4dCkge1xyXG4gICAgICB2YXIgc2F2ZURhdGUgPSBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCA4KSArIGV2ZW50LnRhcmdldC5jbGFzc05hbWU7XHJcblxyXG4gICAgICBpZiAoZXZlbnRzW3NhdmVEYXRlXSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgICBldmVudHNbc2F2ZURhdGVdLnB1c2godGV4dCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZXZlbnRzW3NhdmVEYXRlXSA9IHRleHQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYWxlbmRhckRhdGEnLCBKU09OLnN0cmluZ2lmeShldmVudHMpKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBkZWxldGVFdmVudEZyb21Mb2NhbFN0b3JhZ2UoZXZlbnQpIHtcclxuICAgICAgdmFyIGRlbGV0ZURhdGUgPSBjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCA4KSArIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdFsxXTtcclxuICAgICAgZGVsZXRlIGV2ZW50c1tkZWxldGVEYXRlXTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhbGVuZGFyRGF0YScsIEpTT04uc3RyaW5naWZ5KGV2ZW50cykpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGRlbGV0ZVVzZXJFdmVudCgpIHtcclxuICAgICAgaWYoZXZlbnQudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ3NwYW4nKSByZXR1cm47XHJcbiAgICAgIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLnJlbW92ZSgpO1xyXG5cclxuICAgICAgZGVsZXRlRXZlbnRGcm9tTG9jYWxTdG9yYWdlKGV2ZW50KTtcclxuICAgIH1cclxuICB9XHJcbn0iXX0=
