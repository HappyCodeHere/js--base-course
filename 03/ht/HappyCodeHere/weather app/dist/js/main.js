"use strict";function changeCurrentSchene(e){var r=document.querySelector(".active");switch(r.classList.remove("active"),e){case"welcome":var t=document.querySelector(".welcome-block");t.classList.add("active");break;case"forecast":var n=document.querySelector(".forecast-block");n.classList.add("active");break;case"error":var o=document.querySelector(".error-block");o.classList.add("active")}}function handleDocumentLoad(){var e=window.location.hash;if(e){var r=document.querySelector("header .search input");r.value=e.substring(1),loadData(e.substring(1))}loadHistoryFromStorage(localStorage)}function loadData(e){isFetch&&getForecastFetch(e)}function getForecastFetch(e){return new Promise(function(r,t){var n="AIzaSyDa7DCL2NO9KMPd9DYVk_u3u0wCbm0XXFY";fetch("https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key="+n).then(function(e){return e.json()}).then(function(r){if(0===r.results.length)throw new Error(r.status);var t=r.results[0].geometry.location,n=t.lat,o=t.lng;return e=r.results[0].formatted_address,fetch("https://shrouded-spire-35703.herokuapp.com/forecast/"+n+","+o+"?lang=en&units=si")}).then(function(e){return e.json()}).then(function(r){renderMainInformation(r,e),setTimeout(function(){changeCurrentSchene("forecast"),saveCityToHistory(e),renderSearchHistory(searchHistory)},100)})["catch"](function(e){handleApiError(e)})})}function handleApiError(e){var r=document.querySelector(".error-block");r.innerHTML+=e,changeCurrentSchene("error")}function renderMainInformation(e,r){var t=document.querySelector("section.main h2");t.innerHTML=r;var n=new Skycons({color:"#e6a831"});n.add(document.querySelector("section.main .forecast-icon"),e.currently.icon),n.play();var o=document.querySelector(".forecast-info span.temperature");o.innerHTML="Temperature: "+e.currently.temperature.toFixed(1)+"Â°C";var a=document.querySelector("section.main span.humidity");a.innerHTML="Humidity: "+e.currently.humidity+"%";var c=document.querySelector("section.main span.wind-speed");c.innerHTML="Wind speed: "+e.currently.windSpeed+"m/s";var i=document.querySelector(".summary p");i.innerHTML=e.currently.summary}function renderSearchHistory(e){var r=document.querySelector("section.history ul");r.innerHTML="";for(var t=0;t<e.length;t++)r.innerHTML+='<li class="list-group-item">'+e[t]+"</li>"}function saveCityToHistory(e){searchHistory[0]!==e&&(searchHistory.indexOf(e)>0&&searchHistory.splice(searchHistory.indexOf(e),1),searchHistory.length>4&&searchHistory.pop(),searchHistory.unshift(e),saveHistoryToStorage(localStorage,searchHistory))}function loadHistoryFromStorage(e){var r=e.getItem("forecast");searchHistory=JSON.parse(r)||[]}function saveHistoryToStorage(e,r){e.setItem("forecast",JSON.stringify(r))}var isFetch=!0,searchHistory=[];changeCurrentSchene("welcome"),handleDocumentLoad();var tougle=document.querySelector(".switcher input");tougle.addEventListener("change",function(){var e=event.target.checked,r=document.querySelector(".switcher span");e?r.innerHTML="Fetch":r.innerHTML="XHR"});var buttonSearch=document.querySelector("header button");buttonSearch.addEventListener("click",function(){var e=document.querySelector("header .search input"),r=e.value;loadData(r),window.location.hash=r});var inputSearch=document.querySelector("header .search input");inputSearch.addEventListener("submit",loadData),inputSearch.addEventListener("keyup",function(e){if(13===e.keyCode){var r=document.querySelector("header .search input"),t=r.value;loadData(t),window.location.hash=t}});var ul=document.querySelector(".history ul");ul.addEventListener("click",function(){if(event.target.matches("li")){var e=document.querySelector("header .search input"),r=event.target.innerHTML;e.value=r,window.location.hash=r,loadData(r)}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiY2hhbmdlQ3VycmVudFNjaGVuZSIsInNjaGVuZSIsImFjdGl2ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsInJlbW92ZSIsIndlbGNvbWUiLCJhZGQiLCJmb3JlY2FzdCIsImVycm9yIiwiaGFuZGxlRG9jdW1lbnRMb2FkIiwiaGFzaCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaW5wdXRTZWFyY2giLCJ2YWx1ZSIsInN1YnN0cmluZyIsImxvYWREYXRhIiwibG9hZEhpc3RvcnlGcm9tU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsImNpdHkiLCJpc0ZldGNoIiwiZ2V0Rm9yZWNhc3RGZXRjaCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiR09PR0xFX0FQSV9LRVkiLCJmZXRjaCIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJkYXRhIiwicmVzdWx0cyIsImxlbmd0aCIsIkVycm9yIiwic3RhdHVzIiwiX2RhdGEkcmVzdWx0cyQwJGdlb21lIiwiZ2VvbWV0cnkiLCJsYXQiLCJsbmciLCJmb3JtYXR0ZWRfYWRkcmVzcyIsInJlbmRlck1haW5JbmZvcm1hdGlvbiIsInNldFRpbWVvdXQiLCJzYXZlQ2l0eVRvSGlzdG9yeSIsInJlbmRlclNlYXJjaEhpc3RvcnkiLCJzZWFyY2hIaXN0b3J5IiwiaGFuZGxlQXBpRXJyb3IiLCJlcnIiLCJpbm5lckhUTUwiLCJjaXR5RGF0YSIsImNpdHlOYW1lIiwidGl0bGUiLCJza3ljb25zIiwiU2t5Y29ucyIsImNvbG9yIiwiY3VycmVudGx5IiwiaWNvbiIsInBsYXkiLCJ0ZW1wZXJhdHVyZSIsInRvRml4ZWQiLCJodW1pZGl0eSIsIndpbmRTcGVlZCIsInN1bW1hcnkiLCJoaXN0b3J5IiwidWwiLCJpIiwiaW5kZXhPZiIsInNwbGljZSIsInBvcCIsInVuc2hpZnQiLCJzYXZlSGlzdG9yeVRvU3RvcmFnZSIsInN0b3JhZ2UiLCJnZXRJdGVtIiwiSlNPTiIsInBhcnNlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInRvdWdsZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja2VkIiwiZXZlbnQiLCJ0YXJnZXQiLCJyZXF1ZXN0VHlwZSIsImJ1dHRvblNlYXJjaCIsImlucHV0IiwiZSIsImtleUNvZGUiLCJtYXRjaGVzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQU1BLFNBQVNBLHFCQUFvQkMsR0FDM0IsR0FBTUMsR0FBU0MsU0FBU0MsY0FBYyxVQUd0QyxRQUZBRixFQUFPRyxVQUFVQyxPQUFPLFVBRWhCTCxHQUNOLElBQUssVUFDSCxHQUFNTSxHQUFVSixTQUFTQyxjQUFjLGlCQUN2Q0csR0FBUUYsVUFBVUcsSUFBSSxTQUN0QixNQUVGLEtBQUssV0FDSCxHQUFNQyxHQUFXTixTQUFTQyxjQUFjLGtCQUN4Q0ssR0FBU0osVUFBVUcsSUFBSSxTQUN2QixNQUVGLEtBQUssUUFDSCxHQUFNRSxHQUFRUCxTQUFTQyxjQUFjLGVBQ3JDTSxHQUFNTCxVQUFVRyxJQUFJLFdBeUQxQixRQUFTRyxzQkFBcUIsR0FDcEJDLEdBQVNDLE9BQU9DLFNBQWhCRixJQUNSLElBQUlBLEVBQU0sQ0FDUixHQUFNRyxHQUFjWixTQUFTQyxjQUFjLHVCQUMzQ1csR0FBWUMsTUFBUUosRUFBS0ssVUFBVSxHQUNuQ0MsU0FBU04sRUFBS0ssVUFBVSxJQUUxQkUsdUJBQXVCQyxjQUd6QixRQUFTRixVQUFTRyxHQUNaQyxTQUNGQyxpQkFBaUJGLEdBTXJCLFFBQVNFLGtCQUFpQkYsR0FDeEIsTUFBTyxJQUFJRyxTQUFRLFNBQUNDLEVBQVNDLEdBRTNCLEdBQU1DLEdBQWlCLHlDQUV2QkMsT0FBQUEsNkRBQW1FUCxFQUFuRSxRQUErRU0sR0FDNUVFLEtBQUssU0FBQUMsR0FDSixNQUFPQSxHQUFTQyxTQUVqQkYsS0FBSyxTQUFBRyxHQUNKLEdBQTRCLElBQXhCQSxFQUFLQyxRQUFRQyxPQUFjLEtBQU0sSUFBSUMsT0FBTUgsRUFBS0ksT0FEeEMsSUFBQUMsR0FFU0wsRUFBS0MsUUFBUSxHQUFHSyxT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LEdBQWtCLEtBQWRBLEVBQUVDLFFBQWdCLENBQ3BCLEdBQU1GLEdBQVFsRixTQUFTQyxjQUFjLHdCQUMvQlksRUFBUXFFLEVBQU1yRSxLQUNwQkUsVUFBU0YsR0FDVEgsT0FBT0MsU0FBU0YsS0FBT0ksSUFLM0IsSUFBTWlELElBQUs5RCxTQUFTQyxjQUFjLGNBRWxDNkQsSUFBR2MsaUJBQWlCLFFBQVMsV0FDM0IsR0FBS0UsTUFBTUMsT0FBT00sUUFBUSxNQUExQixDQUVBLEdBQU16RSxHQUFjWixTQUFTQyxjQUFjLHdCQUNyQ1ksRUFBUWlFLE1BQU1DLE9BQU9qQyxTQUUzQmxDLEdBQVlDLE1BQVFBLEVBQ3BCSCxPQUFPQyxTQUFTRixLQUFPSSxFQUV2QkUsU0FBU0YiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5sZXQgaXNGZXRjaCA9IHRydWU7XHJcbmxldCBzZWFyY2hIaXN0b3J5ID0gW107XHJcblxyXG5jaGFuZ2VDdXJyZW50U2NoZW5lKCd3ZWxjb21lJyk7XHJcblxyXG5mdW5jdGlvbiBjaGFuZ2VDdXJyZW50U2NoZW5lKHNjaGVuZSkge1xyXG4gIGNvbnN0IGFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUnKTtcclxuICBhY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcblxyXG4gIHN3aXRjaCAoc2NoZW5lKSB7XHJcbiAgICBjYXNlICd3ZWxjb21lJzpcclxuICAgICAgY29uc3Qgd2VsY29tZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53ZWxjb21lLWJsb2NrJyk7XHJcbiAgICAgIHdlbGNvbWUuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgJ2ZvcmVjYXN0JzpcclxuICAgICAgY29uc3QgZm9yZWNhc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9yZWNhc3QtYmxvY2snKTtcclxuICAgICAgZm9yZWNhc3QuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgJ2Vycm9yJzpcclxuICAgICAgY29uc3QgZXJyb3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3ItYmxvY2snKTtcclxuICAgICAgZXJyb3IuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGRlZmF1bHQ6XHJcblxyXG4gIH1cclxufVxyXG5cclxuaGFuZGxlRG9jdW1lbnRMb2FkKCk7XHJcblxyXG5cclxuY29uc3QgdG91Z2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN3aXRjaGVyIGlucHV0Jyk7XHJcbnRvdWdsZS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgY29uc3QgeyBjaGVja2VkIH0gPSBldmVudC50YXJnZXQ7XHJcbiAgY29uc3QgcmVxdWVzdFR5cGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3dpdGNoZXIgc3BhbicpO1xyXG5cclxuICBpZiAoY2hlY2tlZCkge1xyXG4gICAgcmVxdWVzdFR5cGUuaW5uZXJIVE1MID0gJ0ZldGNoJztcclxuICB9IGVsc2Uge1xyXG4gICAgcmVxdWVzdFR5cGUuaW5uZXJIVE1MID0gJ1hIUic7XHJcbiAgfVxyXG59KVxyXG5cclxuY29uc3QgYnV0dG9uU2VhcmNoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyIGJ1dHRvbicpO1xyXG5idXR0b25TZWFyY2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkZXIgLnNlYXJjaCBpbnB1dCcpO1xyXG4gIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgbG9hZERhdGEodmFsdWUpO1xyXG4gIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gdmFsdWU7XHJcbn0pO1xyXG5cclxuY29uc3QgaW5wdXRTZWFyY2ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkZXIgLnNlYXJjaCBpbnB1dCcpO1xyXG5pbnB1dFNlYXJjaC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBsb2FkRGF0YSk7XHJcbmlucHV0U2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGUpID0+IHtcclxuICBpZiAoZS5rZXlDb2RlID09PSAxMykge1xyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkZXIgLnNlYXJjaCBpbnB1dCcpO1xyXG4gICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgIGxvYWREYXRhKHZhbHVlKTtcclxuICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gdmFsdWU7XHJcbiAgfVxyXG59KTtcclxuXHJcblxyXG5jb25zdCB1bCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oaXN0b3J5IHVsJyk7XHJcblxyXG51bC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBpZiAoIWV2ZW50LnRhcmdldC5tYXRjaGVzKCdsaScpKSByZXR1cm47XHJcblxyXG4gIGNvbnN0IGlucHV0U2VhcmNoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyIC5zZWFyY2ggaW5wdXQnKTtcclxuICBjb25zdCB2YWx1ZSA9IGV2ZW50LnRhcmdldC5pbm5lckhUTUw7XHJcblxyXG4gIGlucHV0U2VhcmNoLnZhbHVlID0gdmFsdWU7XHJcbiAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSB2YWx1ZTtcclxuXHJcbiAgbG9hZERhdGEodmFsdWUpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURvY3VtZW50TG9hZCgpIHtcclxuICBjb25zdCB7IGhhc2ggfSA9IHdpbmRvdy5sb2NhdGlvbjtcclxuICBpZiAoaGFzaCkge1xyXG4gICAgY29uc3QgaW5wdXRTZWFyY2ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkZXIgLnNlYXJjaCBpbnB1dCcpO1xyXG4gICAgaW5wdXRTZWFyY2gudmFsdWUgPSBoYXNoLnN1YnN0cmluZygxKTtcclxuICAgIGxvYWREYXRhKGhhc2guc3Vic3RyaW5nKDEpKTtcclxuICB9XHJcbiAgbG9hZEhpc3RvcnlGcm9tU3RvcmFnZShsb2NhbFN0b3JhZ2UpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBsb2FkRGF0YShjaXR5KSB7XHJcbiAgaWYgKGlzRmV0Y2gpIHtcclxuICAgIGdldEZvcmVjYXN0RmV0Y2goY2l0eSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIC8vIGdldEZvcmVjYXN0WEhSKGNpdHkpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Rm9yZWNhc3RGZXRjaChjaXR5KSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHJcbiAgICBjb25zdCBHT09HTEVfQVBJX0tFWSA9ICdBSXphU3lEYTdEQ0wyTk85S01QZDlEWVZrX3UzdTB3Q2JtMFhYRlknO1xyXG5cclxuICAgIGZldGNoKGBodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvZ2VvY29kZS9qc29uP2FkZHJlc3M9JHtjaXR5fSZrZXk9JHtHT09HTEVfQVBJX0tFWX1gKVxyXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgICAgaWYgKGRhdGEucmVzdWx0cy5sZW5ndGggPT09IDApIHRocm93IG5ldyBFcnJvcihkYXRhLnN0YXR1cyk7XHJcbiAgICAgICAgY29uc3QgeyBsYXQsIGxuZyB9ID0gZGF0YS5yZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uO1xyXG4gICAgICAgIGNpdHkgPSBkYXRhLnJlc3VsdHNbMF0uZm9ybWF0dGVkX2FkZHJlc3M7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL3Nocm91ZGVkLXNwaXJlLTM1NzAzLmhlcm9rdWFwcC5jb20vZm9yZWNhc3QvJHtsYXR9LCR7bG5nfT9sYW5nPWVuJnVuaXRzPXNpYCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihkYXRhID0+IHtcclxuICAgICAgICByZW5kZXJNYWluSW5mb3JtYXRpb24oZGF0YSwgY2l0eSk7XHJcblxyXG5cclxuICAgICAgICAvLyBtYXliZSBmb3IgYmV0dGVyIFVJXHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBjaGFuZ2VDdXJyZW50U2NoZW5lKCdmb3JlY2FzdCcpO1xyXG4gICAgICAgICAgc2F2ZUNpdHlUb0hpc3RvcnkoY2l0eSk7XHJcbiAgICAgICAgICByZW5kZXJTZWFyY2hIaXN0b3J5KHNlYXJjaEhpc3RvcnkpO1xyXG4gICAgICAgIH0sIDEwMCk7XHJcblxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGhhbmRsZUFwaUVycm9yKGVycm9yKTtcclxuICAgICAgfSlcclxuICB9KVxyXG59XHJcblxyXG4vLyBmdW5jdGlvbiBnZXRGb3JlY2FzdFhIUih1cmwpIHtcclxuLy9cclxuLy8gICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbi8vXHJcbi8vICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbi8vICAgICB4aHIub3BlbignR0VUJywgdXJsLCB0cnVlKTtcclxuLy9cclxuLy8gICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuLy8gICAgICAgaWYgKHRoaXMuc3RhdHVzID09IDIwMCkge1xyXG4vLyAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XHJcbi8vICAgICAgIH0gZWxzZSB7XHJcbi8vICAgICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKHRoaXMuc3RhdHVzVGV4dCk7XHJcbi8vICAgICAgICAgZXJyb3IuY29kZSA9IHRoaXMuc3RhdHVzO1xyXG4vLyAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbi8vICAgICAgIH1cclxuLy8gICAgIH07XHJcbi8vXHJcbi8vICAgICB4aHIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xyXG4vLyAgICAgICByZWplY3QobmV3IEVycm9yKFwiTmV0d29yayBFcnJvclwiKSk7XHJcbi8vICAgICB9O1xyXG4vL1xyXG4vLyAgICAgeGhyLnNlbmQoKTtcclxuLy8gICB9KTtcclxuLy9cclxuLy8gfVxyXG5cclxuLy8gZnVuY3Rpb24gZ2V0Rm9yZWNhc3RGZXRjaDIodXJsKSB7XHJcbi8vICAgcmV0dXJuIGZldGNoKHVybClcclxuLy8gICAgIC50aGVuKHJlc3BvbnNlKVxyXG4vLyB9XHJcblxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXBpRXJyb3IoZXJyb3IpIHtcclxuICBjb25zdCBlcnIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZXJyb3ItYmxvY2snKTtcclxuICBlcnIuaW5uZXJIVE1MICs9IGVycm9yO1xyXG4gIGNoYW5nZUN1cnJlbnRTY2hlbmUoJ2Vycm9yJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlck1haW5JbmZvcm1hdGlvbihjaXR5RGF0YSwgY2l0eU5hbWUpIHtcclxuXHJcbiAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uLm1haW4gaDInKTtcclxuICB0aXRsZS5pbm5lckhUTUwgPSBjaXR5TmFtZTtcclxuXHJcbiAgLy8gaWNvbnNcclxuICBjb25zdCBza3ljb25zID0gbmV3IFNreWNvbnMoe1wiY29sb3JcIjogXCIjZTZhODMxXCJ9KTtcclxuICBza3ljb25zLmFkZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uLm1haW4gLmZvcmVjYXN0LWljb24nKSwgY2l0eURhdGEuY3VycmVudGx5Lmljb24pO1xyXG4gIHNreWNvbnMucGxheSgpO1xyXG5cclxuICBjb25zdCB0ZW1wZXJhdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JlY2FzdC1pbmZvIHNwYW4udGVtcGVyYXR1cmUnKTtcclxuICB0ZW1wZXJhdHVyZS5pbm5lckhUTUwgPSBgVGVtcGVyYXR1cmU6ICR7Y2l0eURhdGEuY3VycmVudGx5LnRlbXBlcmF0dXJlLnRvRml4ZWQoMSl9wrBDYDtcclxuXHJcbiAgY29uc3QgaHVtaWRpdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzZWN0aW9uLm1haW4gc3Bhbi5odW1pZGl0eScpO1xyXG4gIGh1bWlkaXR5LmlubmVySFRNTCA9IGBIdW1pZGl0eTogJHtjaXR5RGF0YS5jdXJyZW50bHkuaHVtaWRpdHl9JWA7XHJcblxyXG4gIGNvbnN0IHdpbmRTcGVlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb24ubWFpbiBzcGFuLndpbmQtc3BlZWQnKTtcclxuICB3aW5kU3BlZWQuaW5uZXJIVE1MID0gYFdpbmQgc3BlZWQ6ICR7Y2l0eURhdGEuY3VycmVudGx5LndpbmRTcGVlZH1tL3NgO1xyXG5cclxuICBjb25zdCBzdW1tYXJ5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1bW1hcnkgcCcpO1xyXG4gIHN1bW1hcnkuaW5uZXJIVE1MID0gY2l0eURhdGEuY3VycmVudGx5LnN1bW1hcnk7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiByZW5kZXJTZWFyY2hIaXN0b3J5KGhpc3RvcnkpIHtcclxuICBjb25zdCB1bCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3NlY3Rpb24uaGlzdG9yeSB1bCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGhpc3RvcnkubGVuZ3RoOyBpKyspIHtcclxuICAgIHVsLmlubmVySFRNTCArPSBgPGxpIGNsYXNzPVwibGlzdC1ncm91cC1pdGVtXCI+JHtoaXN0b3J5W2ldfTwvbGk+YDtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNhdmVDaXR5VG9IaXN0b3J5KGNpdHkpIHtcclxuICBpZiAoc2VhcmNoSGlzdG9yeVswXSA9PT0gY2l0eSkgcmV0dXJuO1xyXG4gIGlmIChzZWFyY2hIaXN0b3J5LmluZGV4T2YoY2l0eSkgPiAwKSB7XHJcbiAgICAgc2VhcmNoSGlzdG9yeS5zcGxpY2Uoc2VhcmNoSGlzdG9yeS5pbmRleE9mKGNpdHkpLCAxKTtcclxuICB9XHJcbiAgaWYgKHNlYXJjaEhpc3RvcnkubGVuZ3RoID4gNCkge1xyXG4gICAgc2VhcmNoSGlzdG9yeS5wb3AoKTtcclxuICB9XHJcbiAgc2VhcmNoSGlzdG9yeS51bnNoaWZ0KGNpdHkpO1xyXG5cclxuICBzYXZlSGlzdG9yeVRvU3RvcmFnZShsb2NhbFN0b3JhZ2UsIHNlYXJjaEhpc3RvcnkpO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gbG9hZEhpc3RvcnlGcm9tU3RvcmFnZShzdG9yYWdlKSB7XHJcbiAgY29uc3QgZm9yZWNhc3QgPSBzdG9yYWdlLmdldEl0ZW0oJ2ZvcmVjYXN0Jyk7XHJcbiAgc2VhcmNoSGlzdG9yeSA9IEpTT04ucGFyc2UoZm9yZWNhc3QpIHx8IFtdO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzYXZlSGlzdG9yeVRvU3RvcmFnZShzdG9yYWdlLCBoaXN0b3J5KSB7XHJcbiAgc3RvcmFnZS5zZXRJdGVtKCdmb3JlY2FzdCcsIEpTT04uc3RyaW5naWZ5KGhpc3RvcnkpKTtcclxufSJdfQ==
